---
title: 젠킨스와 깃헙 연동하기
date: 2022-01-11 17:49:00 +0900
categories: [blog]
tags: [jenkins, github]     # TAG names should always be lowercase
---



 

저번 포스팅에서 설치한 젠킨스와 깃헙을 연동해 보았다.

우선 젠킨스에서 깃헙에 접근할 수 있도록 토큰을 발행하기 위해

![github_personal_menu](/img/a004/github_personal_menu.png){: .normal }

개인 메뉴에서 'settings'페이지로 이동하고

'Developer settings' -> 'Personal access tokens' -> 'Generate new token'을 차례로 선택해 준다



![github_token_setting](/img/a004/github_token_setting.png){: .normal }

젠킨스에서 깃헙에 추가적인 작업은 하지 않을 계획이므로 웹훅에 접근할 수 있는 권한만 허용해 준다.

(다른 작업을 위해서는 [Scopes for OAuth Apps](https://docs.github.com/en/developers/apps/building-oauth-apps/scopes-for-oauth-apps)을 참조하여 권한을 조정해 주자)

Note에 적당한 이름을 지정해 주고(꼭 jenkins일 필요는 없음) 'Generate toekn'버튼을 누르면 다음과 같이 토큰 문자열을 주는데,

다시 확인이 불가능하므로 잘 복사해 두자.

![github_token_issued](/img/a004/github_token_issued.png){: .normal }





이제 깃헙에 테스트용으로 적당한 리포지토리를 생성해 주고,

리포지토리의 'Settings' -> 'Webhooks'페이지로 들어간다.

![github_token_issued](/img/a004/add_project_webhook.png){: .normal }

위와 같은 페이지가 보일 텐데, 'Payload URL'칸에 

'http://{외부에서 jenkins에 접속 가능한 주소(포트넘버 포함)}/github-webhook/'

의 형태로 입력하고 Update webhook을 누른다.

(※마지막 '/'가 빠질 경우 리다이렉트로 인해 '304 no-sniff' 에러를 발생시키므로 '/'가 빠지지 않도록 주의한다.)





여기까지가 github 설정내용이고

이제부터 jenkins를 설정해야 한다.






'Jenkins 관리' -> '시스템 설정' 페이지로 접속하여 GitHub 탭을 찾아 'Add GitHub Server'를 누른다.

![jenkins_github_server](/img/a004/jenkins_github_server.png){: .normal }

Name 과 API URL은 건들 필요 없이 기본 설정을 사용하면 되고,

Credentials 탭의 'Add'를 누른다.



그럼 다음과 같은 창이 뜰텐데,

![jenkins_add_credentials](/img/a004/jenkins_add_credentials.png){: .normal }

Kind를 'Secret text'로 변경한 뒤,

Secret에 아까 github에서 발행한 토큰값을 입력해 준다.

ID는 github ID를 입력하고,

Description에는 해당 토큰을 알아볼 수 있도록 적당한 이름을 지정해 주면 된다.(꼭 'github token'일 필요는 없음)



Add버튼을 누르고, 'Test connection' 버튼을 눌러 연결이 정상적으로 되는지 확인한다.



페이지 하단의 '저장' 버튼을 누른 뒤, 대시보드로 나가서 새로운 Item을 생성한다.

![jenkins_new_item](/img/a004/jenkins_new_item.png){: .normal }

적당한 이름을 입력하고 'Freestyle project'를 선택한 뒤 OK를 누른다.







![jenkins_setting](/img/a004/jenkins_setting.png){: .normal }

GitHub Project 체크박스를 선택해 주고 해당 프로젝트 리포지토리 메인 페이지 주소를 입력해 준다.(필수는 아님)



소스코드 관리에서 Git을 선택하고, Repository URL에 해당 리포지토리의 git 주소(끝이 .git인 주소)를 입력하고

Credentials 옆의 Add 버튼을 눌러 새 Credential을 설정한다.



Branches to build 탭에서 특정 브랜치만 빌드하도록 설정할 수 있는데, 필자는 main 브랜치만 빌드하도록 설정했다.



Credential 추가 시에, 다음과 같은 화면이 나오는데,

![jenkins_add_credentials2](/img/a004/jenkins_add_credentials2.png){: .normal }

Username과 Password에 github ID,PW를 입력하고, Description에 적당한 설명을 입력하고 Add를 클릭하면 된다.

ID는 Jenkins가 이 Credential을 내부적으로 인식하기 위한 유니크 아이디를 입력해야 하는데, 비워 두면 Jenkins가 알아서 생성한다.





다시 설정을 마저 하자면,

![jenkins_setting2](/img/a004/jenkins_setting2.png){: .normal }

GitHub hook trigger for GITScm polling 체크박스에 체크해주고,

필요에 따라 Add build step을 이용해, 저장소 클론이 완료된 이후 작업을 지정할 수 있다.





이제 저장하고, 생성한 리포지토리에 텍스트 파일 등을 추가한 뒤, push 작업을 하면,

![jenkins_github_hook_log](/img/a004/jenkins_github_hook_log.png){: .normal }

위와 같은 로그가 생성된 것을 확인할 수 있다.






jenkins-github 연동 완료!